#!/usr/bin/env bash

set -euf -o pipefail

HOST="i.jarv.org"
dir=$(dirname "$0")
file_dir="$dir/../files"
rsync_opts=(
  --checksum --itemize-changes --human-readable
  --recursive --links --rsync-path="sudo rsync"
)

rsync "${rsync_opts[@]}" "$file_dir"/ root@$HOST:/

ssh $HOST 'sudo systemctl reload caddy'
